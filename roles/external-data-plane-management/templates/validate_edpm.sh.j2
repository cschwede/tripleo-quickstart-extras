#!/bin/bash

set -eux

# Discover new compute nodes
sudo podman exec -it nova_api nova-manage cell_v2 discover_hosts --verbose

# Export standalone cloud
export OS_CLOUD=standalone

# List Available Zones
openstack availability zone list

# List hosts
openstack host list

# List Hypervisors
openstack hypervisor list

# List Compute Services
openstack compute service list
if [ "$?" == "0" ]; then
    echo "External Compute Deployment Validation, SUCCESS"
    exit 0
else
    exit 1
fi
